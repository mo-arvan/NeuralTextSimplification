[06/05/22 04:50:56 INFO] Using GPU(s): 2
[06/05/22 04:50:56 WARNING] The caching CUDA memory allocator is enabled. This allocator improves performance at the cost of a higher GPU memory usage. To optimize for memory, consider disabling it by setting the environment variable: THC_CACHING_ALLOCATOR=0
[06/05/22 04:50:56 INFO] Training Sequence to Sequence with Attention model
[06/05/22 04:50:56 INFO] Loading data from '/workspace/data/NTS-train.t7'...
[06/05/22 04:51:08 INFO]  * vocabulary size: source = 50004; target = 50004
[06/05/22 04:51:08 INFO]  * additional features: source = 0; target = 0
[06/05/22 04:51:08 INFO]  * maximum sequence length: source = 80; target = 81
[06/05/22 04:51:08 INFO]  * number of training sentences: 282954
[06/05/22 04:51:08 INFO]  * 1147 batches, max size: 256 (even), avg size: 246.690497, capacity: 100%
[06/05/22 04:51:08 INFO] Building model...
[06/05/22 04:51:08 INFO]  * Encoder:
[06/05/22 04:51:09 INFO]    - with word embeddings size: 512
[06/05/22 04:51:09 INFO]    - Simple LSTM Encoder: 2 layers, rnn_size 512, dropout 0.3
[06/05/22 04:51:09 INFO]  * Decoder:
[06/05/22 04:51:10 INFO]    - with word embeddings size: 512
[06/05/22 04:51:10 INFO]    - Global Attention: general
[06/05/22 04:51:12 INFO] Initializing parameters...
[06/05/22 04:51:14 INFO]  * number of parameters: 87096148
[06/05/22 04:51:14 INFO] Preparing memory optimization...
[06/05/22 04:51:14 INFO]  * sharing 69% of output/gradInput tensors memory between clones
[06/05/22 04:51:14 INFO] Start training...
[06/05/22 04:51:14 INFO] 
[06/05/22 04:55:38 INFO] Epoch 1 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 11655 ; Perplexity 2709.01
[06/05/22 04:59:53 INFO] Epoch 1 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12415 ; Perplexity 448.62
[06/05/22 05:01:09 INFO] Epoch 1 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 13092 ; Perplexity 327.62
[06/05/22 05:01:18 INFO] Validation perplexity: 395.71
[06/05/22 05:01:18 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch1_395.71.t7'...
[06/05/22 05:01:21 INFO] 
[06/05/22 05:05:33 INFO] Epoch 2 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12496 ; Perplexity 251.82
[06/05/22 05:09:47 INFO] Epoch 2 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12584 ; Perplexity 158.18
[06/05/22 05:10:59 INFO] Epoch 2 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12398 ; Perplexity 87.23
[06/05/22 05:11:07 INFO] Validation perplexity: 73.61
[06/05/22 05:11:07 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch2_73.61.t7'...
[06/05/22 05:11:10 INFO] 
[06/05/22 05:15:24 INFO] Epoch 3 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12640 ; Perplexity 56.78
[06/05/22 05:19:32 INFO] Epoch 3 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12460 ; Perplexity 38.15
[06/05/22 05:20:47 INFO] Epoch 3 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12383 ; Perplexity 31.99
[06/05/22 05:20:56 INFO] Validation perplexity: 25.15
[06/05/22 05:20:56 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch3_25.15.t7'...
[06/05/22 05:20:58 INFO] 
[06/05/22 05:25:12 INFO] Epoch 4 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12501 ; Perplexity 26.77
[06/05/22 05:29:22 INFO] Epoch 4 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12573 ; Perplexity 23.81
[06/05/22 05:30:37 INFO] Epoch 4 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12335 ; Perplexity 21.96
[06/05/22 05:30:45 INFO] Validation perplexity: 17.35
[06/05/22 05:30:45 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch4_17.35.t7'...
[06/05/22 05:30:47 INFO] 
[06/05/22 05:35:01 INFO] Epoch 5 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12620 ; Perplexity 19.32
[06/05/22 05:39:12 INFO] Epoch 5 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12400 ; Perplexity 18.50
[06/05/22 05:40:26 INFO] Epoch 5 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12542 ; Perplexity 17.57
[06/05/22 05:40:35 INFO] Validation perplexity: 14.19
[06/05/22 05:40:35 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch5_14.19.t7'...
[06/05/22 05:40:37 INFO] 
[06/05/22 05:44:51 INFO] Epoch 6 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12724 ; Perplexity 15.68
[06/05/22 05:49:02 INFO] Epoch 6 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12343 ; Perplexity 15.55
[06/05/22 05:50:15 INFO] Epoch 6 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12454 ; Perplexity 15.28
[06/05/22 05:50:24 INFO] Validation perplexity: 12.86
[06/05/22 05:50:24 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch6_12.86.t7'...
[06/05/22 05:50:26 INFO] 
[06/05/22 05:54:36 INFO] Epoch 7 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12322 ; Perplexity 13.77
[06/05/22 05:58:51 INFO] Epoch 7 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12589 ; Perplexity 13.42
[06/05/22 06:00:04 INFO] Epoch 7 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12995 ; Perplexity 13.41
[06/05/22 06:00:13 INFO] Validation perplexity: 12.73
[06/05/22 06:00:13 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch7_12.73.t7'...
[06/05/22 06:00:15 INFO] 
[06/05/22 06:04:29 INFO] Epoch 8 ; Iteration 500/1147 ; Learning rate 0.7000 ; Source tokens/s 12587 ; Perplexity 11.32
[06/05/22 06:08:38 INFO] Epoch 8 ; Iteration 1000/1147 ; Learning rate 0.7000 ; Source tokens/s 12416 ; Perplexity 11.53
[06/05/22 06:09:53 INFO] Epoch 8 ; Iteration 1147/1147 ; Learning rate 0.7000 ; Source tokens/s 12783 ; Perplexity 11.39
[06/05/22 06:10:01 INFO] Validation perplexity: 11.00
[06/05/22 06:10:01 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch8_11.00.t7'...
[06/05/22 06:10:04 INFO] 
[06/05/22 06:14:20 INFO] Epoch 9 ; Iteration 500/1147 ; Learning rate 0.4900 ; Source tokens/s 12816 ; Perplexity 10.09
[06/05/22 06:18:27 INFO] Epoch 9 ; Iteration 1000/1147 ; Learning rate 0.4900 ; Source tokens/s 12275 ; Perplexity 10.25
[06/05/22 06:19:41 INFO] Epoch 9 ; Iteration 1147/1147 ; Learning rate 0.4900 ; Source tokens/s 12480 ; Perplexity 10.20
[06/05/22 06:19:49 INFO] Validation perplexity: 10.42
[06/05/22 06:19:49 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch9_10.42.t7'...
[06/05/22 06:19:52 INFO] 
[06/05/22 06:24:05 INFO] Epoch 10 ; Iteration 500/1147 ; Learning rate 0.3430 ; Source tokens/s 12549 ; Perplexity 9.34
[06/05/22 06:28:17 INFO] Epoch 10 ; Iteration 1000/1147 ; Learning rate 0.3430 ; Source tokens/s 12487 ; Perplexity 9.43
[06/05/22 06:29:30 INFO] Epoch 10 ; Iteration 1147/1147 ; Learning rate 0.3430 ; Source tokens/s 12474 ; Perplexity 9.55
[06/05/22 06:29:39 INFO] Validation perplexity: 10.44
[06/05/22 06:29:39 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch10_10.44.t7'...
[06/05/22 06:29:41 INFO] 
[06/05/22 06:33:52 INFO] Epoch 11 ; Iteration 500/1147 ; Learning rate 0.2401 ; Source tokens/s 12772 ; Perplexity 8.84
[06/05/22 06:38:04 INFO] Epoch 11 ; Iteration 1000/1147 ; Learning rate 0.2401 ; Source tokens/s 12380 ; Perplexity 9.01
[06/05/22 06:39:18 INFO] Epoch 11 ; Iteration 1147/1147 ; Learning rate 0.2401 ; Source tokens/s 12337 ; Perplexity 8.69
[06/05/22 06:39:27 INFO] Validation perplexity: 10.29
[06/05/22 06:39:27 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch11_10.29.t7'...
[06/05/22 06:39:29 INFO] 
[06/05/22 06:43:41 INFO] Epoch 12 ; Iteration 500/1147 ; Learning rate 0.1681 ; Source tokens/s 12386 ; Perplexity 8.51
[06/05/22 06:47:54 INFO] Epoch 12 ; Iteration 1000/1147 ; Learning rate 0.1681 ; Source tokens/s 12554 ; Perplexity 8.56
[06/05/22 06:49:07 INFO] Epoch 12 ; Iteration 1147/1147 ; Learning rate 0.1681 ; Source tokens/s 12992 ; Perplexity 8.64
[06/05/22 06:49:15 INFO] Validation perplexity: 10.29
[06/05/22 06:49:15 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch12_10.29.t7'...
[06/05/22 06:49:18 INFO] 
[06/05/22 06:53:29 INFO] Epoch 13 ; Iteration 500/1147 ; Learning rate 0.1176 ; Source tokens/s 12618 ; Perplexity 8.22
[06/05/22 06:57:41 INFO] Epoch 13 ; Iteration 1000/1147 ; Learning rate 0.1176 ; Source tokens/s 12414 ; Perplexity 8.34
[06/05/22 06:58:55 INFO] Epoch 13 ; Iteration 1147/1147 ; Learning rate 0.1176 ; Source tokens/s 12693 ; Perplexity 8.45
[06/05/22 06:59:04 INFO] Validation perplexity: 10.13
[06/05/22 06:59:04 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch13_10.13.t7'...
[06/05/22 06:59:07 INFO] 
[06/05/22 07:03:17 INFO] Epoch 14 ; Iteration 500/1147 ; Learning rate 0.0824 ; Source tokens/s 12661 ; Perplexity 8.00
[06/05/22 07:07:31 INFO] Epoch 14 ; Iteration 1000/1147 ; Learning rate 0.0824 ; Source tokens/s 12592 ; Perplexity 8.22
[06/05/22 07:08:43 INFO] Epoch 14 ; Iteration 1147/1147 ; Learning rate 0.0824 ; Source tokens/s 12004 ; Perplexity 8.30
[06/05/22 07:08:52 INFO] Validation perplexity: 10.23
[06/05/22 07:08:52 INFO] Saving checkpoint to '/workspace/models/nts_search_17_epoch14_10.23.t7'...
