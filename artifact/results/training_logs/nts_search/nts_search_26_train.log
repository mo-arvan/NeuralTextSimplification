[06/05/22 18:59:15 INFO] Using GPU(s): 1
[06/05/22 18:59:15 WARNING] The caching CUDA memory allocator is enabled. This allocator improves performance at the cost of a higher GPU memory usage. To optimize for memory, consider disabling it by setting the environment variable: THC_CACHING_ALLOCATOR=0
[06/05/22 18:59:15 INFO] Training Sequence to Sequence with Attention model
[06/05/22 18:59:15 INFO] Loading data from '/workspace/data/NTS-train.t7'...
[06/05/22 18:59:27 INFO]  * vocabulary size: source = 50004; target = 50004
[06/05/22 18:59:27 INFO]  * additional features: source = 0; target = 0
[06/05/22 18:59:27 INFO]  * maximum sequence length: source = 80; target = 81
[06/05/22 18:59:27 INFO]  * number of training sentences: 282954
[06/05/22 18:59:27 INFO]  * 1147 batches, max size: 256 (even), avg size: 246.690497, capacity: 100%
[06/05/22 18:59:27 INFO] Building model...
[06/05/22 18:59:27 INFO]  * Encoder:
[06/05/22 18:59:28 INFO]    - with word embeddings size: 512
[06/05/22 18:59:28 INFO]    - Simple LSTM Encoder: 2 layers, rnn_size 512, dropout 0.3
[06/05/22 18:59:28 INFO]  * Decoder:
[06/05/22 18:59:29 INFO]    - with word embeddings size: 512
[06/05/22 18:59:29 INFO]    - Global Attention: general
[06/05/22 18:59:31 INFO] Initializing parameters...
[06/05/22 18:59:33 INFO]  * number of parameters: 87096148
[06/05/22 18:59:33 INFO] Preparing memory optimization...
[06/05/22 18:59:33 INFO]  * sharing 69% of output/gradInput tensors memory between clones
[06/05/22 18:59:33 INFO] Start training...
[06/05/22 18:59:33 INFO] 
[06/05/22 19:04:00 INFO] Epoch 1 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 11449 ; Perplexity 2258.80
[06/05/22 19:08:20 INFO] Epoch 1 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12537 ; Perplexity 442.81
[06/05/22 19:09:36 INFO] Epoch 1 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12153 ; Perplexity 315.59
[06/05/22 19:09:45 INFO] Validation perplexity: 407.85
[06/05/22 19:09:45 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch1_407.85.t7'...
[06/05/22 19:09:47 INFO] 
[06/05/22 19:13:57 INFO] Epoch 2 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12158 ; Perplexity 248.02
[06/05/22 19:18:19 INFO] Epoch 2 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12633 ; Perplexity 164.84
[06/05/22 19:19:32 INFO] Epoch 2 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12204 ; Perplexity 90.00
[06/05/22 19:19:41 INFO] Validation perplexity: 78.31
[06/05/22 19:19:41 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch2_78.31.t7'...
[06/05/22 19:19:43 INFO] 
[06/05/22 19:23:57 INFO] Epoch 3 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12433 ; Perplexity 57.67
[06/05/22 19:28:11 INFO] Epoch 3 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12421 ; Perplexity 38.28
[06/05/22 19:29:28 INFO] Epoch 3 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12099 ; Perplexity 33.01
[06/05/22 19:29:36 INFO] Validation perplexity: 24.26
[06/05/22 19:29:36 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch3_24.26.t7'...
[06/05/22 19:29:39 INFO] 
[06/05/22 19:33:53 INFO] Epoch 4 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12102 ; Perplexity 27.14
[06/05/22 19:38:10 INFO] Epoch 4 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12659 ; Perplexity 23.64
[06/05/22 19:39:24 INFO] Epoch 4 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12340 ; Perplexity 22.17
[06/05/22 19:39:32 INFO] Validation perplexity: 17.82
[06/05/22 19:39:32 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch4_17.82.t7'...
[06/05/22 19:39:35 INFO] 
[06/05/22 19:43:50 INFO] Epoch 5 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12254 ; Perplexity 19.38
[06/05/22 19:48:04 INFO] Epoch 5 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12236 ; Perplexity 18.51
[06/05/22 19:49:20 INFO] Epoch 5 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 13235 ; Perplexity 16.86
[06/05/22 19:49:28 INFO] Validation perplexity: 14.21
[06/05/22 19:49:28 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch5_14.21.t7'...
[06/05/22 19:49:30 INFO] 
[06/05/22 19:53:45 INFO] Epoch 6 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12453 ; Perplexity 15.71
[06/05/22 19:58:02 INFO] Epoch 6 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12139 ; Perplexity 15.36
[06/05/22 19:59:15 INFO] Epoch 6 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12907 ; Perplexity 14.82
[06/05/22 19:59:24 INFO] Validation perplexity: 13.28
[06/05/22 19:59:24 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch6_13.28.t7'...
[06/05/22 19:59:27 INFO] 
[06/05/22 20:03:38 INFO] Epoch 7 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12247 ; Perplexity 13.54
[06/05/22 20:07:56 INFO] Epoch 7 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12488 ; Perplexity 13.45
[06/05/22 20:09:11 INFO] Epoch 7 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12473 ; Perplexity 13.17
[06/05/22 20:09:20 INFO] Validation perplexity: 11.87
[06/05/22 20:09:20 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch7_11.87.t7'...
[06/05/22 20:09:23 INFO] 
[06/05/22 20:13:37 INFO] Epoch 8 ; Iteration 500/1147 ; Learning rate 0.7000 ; Source tokens/s 12341 ; Perplexity 11.34
[06/05/22 20:17:52 INFO] Epoch 8 ; Iteration 1000/1147 ; Learning rate 0.7000 ; Source tokens/s 12502 ; Perplexity 11.25
[06/05/22 20:19:07 INFO] Epoch 8 ; Iteration 1147/1147 ; Learning rate 0.7000 ; Source tokens/s 12204 ; Perplexity 11.38
[06/05/22 20:19:15 INFO] Validation perplexity: 11.09
[06/05/22 20:19:15 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch8_11.09.t7'...
[06/05/22 20:19:18 INFO] 
[06/05/22 20:23:34 INFO] Epoch 9 ; Iteration 500/1147 ; Learning rate 0.4900 ; Source tokens/s 12359 ; Perplexity 10.12
[06/05/22 20:27:48 INFO] Epoch 9 ; Iteration 1000/1147 ; Learning rate 0.4900 ; Source tokens/s 12389 ; Perplexity 10.07
[06/05/22 20:29:02 INFO] Epoch 9 ; Iteration 1147/1147 ; Learning rate 0.4900 ; Source tokens/s 12470 ; Perplexity 10.05
[06/05/22 20:29:11 INFO] Validation perplexity: 10.47
[06/05/22 20:29:11 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch9_10.47.t7'...
[06/05/22 20:29:13 INFO] 
[06/05/22 20:33:28 INFO] Epoch 10 ; Iteration 500/1147 ; Learning rate 0.3430 ; Source tokens/s 12323 ; Perplexity 9.27
[06/05/22 20:37:44 INFO] Epoch 10 ; Iteration 1000/1147 ; Learning rate 0.3430 ; Source tokens/s 12512 ; Perplexity 9.39
[06/05/22 20:38:57 INFO] Epoch 10 ; Iteration 1147/1147 ; Learning rate 0.3430 ; Source tokens/s 12270 ; Perplexity 9.32
[06/05/22 20:39:05 INFO] Validation perplexity: 10.43
[06/05/22 20:39:05 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch10_10.43.t7'...
[06/05/22 20:39:08 INFO] 
[06/05/22 20:43:20 INFO] Epoch 11 ; Iteration 500/1147 ; Learning rate 0.2401 ; Source tokens/s 12268 ; Perplexity 8.84
[06/05/22 20:47:36 INFO] Epoch 11 ; Iteration 1000/1147 ; Learning rate 0.2401 ; Source tokens/s 12334 ; Perplexity 8.83
[06/05/22 20:48:52 INFO] Epoch 11 ; Iteration 1147/1147 ; Learning rate 0.2401 ; Source tokens/s 13092 ; Perplexity 8.70
[06/05/22 20:49:00 INFO] Validation perplexity: 10.39
[06/05/22 20:49:00 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch11_10.39.t7'...
[06/05/22 20:49:03 INFO] 
[06/05/22 20:53:16 INFO] Epoch 12 ; Iteration 500/1147 ; Learning rate 0.1681 ; Source tokens/s 12330 ; Perplexity 8.43
[06/05/22 20:57:31 INFO] Epoch 12 ; Iteration 1000/1147 ; Learning rate 0.1681 ; Source tokens/s 12381 ; Perplexity 8.50
[06/05/22 20:58:47 INFO] Epoch 12 ; Iteration 1147/1147 ; Learning rate 0.1681 ; Source tokens/s 12587 ; Perplexity 8.55
[06/05/22 20:58:56 INFO] Validation perplexity: 10.26
[06/05/22 20:58:56 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch12_10.26.t7'...
[06/05/22 20:58:59 INFO] 
[06/05/22 21:03:14 INFO] Epoch 13 ; Iteration 500/1147 ; Learning rate 0.1176 ; Source tokens/s 12307 ; Perplexity 8.22
[06/05/22 21:07:28 INFO] Epoch 13 ; Iteration 1000/1147 ; Learning rate 0.1176 ; Source tokens/s 12442 ; Perplexity 8.18
[06/05/22 21:08:43 INFO] Epoch 13 ; Iteration 1147/1147 ; Learning rate 0.1176 ; Source tokens/s 12509 ; Perplexity 8.51
[06/05/22 21:08:51 INFO] Validation perplexity: 10.22
[06/05/22 21:08:51 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch13_10.22.t7'...
[06/05/22 21:08:54 INFO] 
[06/05/22 21:13:07 INFO] Epoch 14 ; Iteration 500/1147 ; Learning rate 0.0824 ; Source tokens/s 12469 ; Perplexity 8.01
[06/05/22 21:17:23 INFO] Epoch 14 ; Iteration 1000/1147 ; Learning rate 0.0824 ; Source tokens/s 12407 ; Perplexity 8.09
[06/05/22 21:18:39 INFO] Epoch 14 ; Iteration 1147/1147 ; Learning rate 0.0824 ; Source tokens/s 12014 ; Perplexity 8.20
[06/05/22 21:18:47 INFO] Validation perplexity: 10.16
[06/05/22 21:18:47 INFO] Saving checkpoint to '/workspace/models/nts_search_26_epoch14_10.16.t7'...
