[06/05/22 20:58:43 INFO] Using GPU(s): 2
[06/05/22 20:58:43 WARNING] The caching CUDA memory allocator is enabled. This allocator improves performance at the cost of a higher GPU memory usage. To optimize for memory, consider disabling it by setting the environment variable: THC_CACHING_ALLOCATOR=0
[06/05/22 20:58:43 INFO] Training Sequence to Sequence with Attention model
[06/05/22 20:58:43 INFO] Loading data from '/workspace/data/NTS-train.t7'...
[06/05/22 20:58:55 INFO]  * vocabulary size: source = 50004; target = 50004
[06/05/22 20:58:55 INFO]  * additional features: source = 0; target = 0
[06/05/22 20:58:55 INFO]  * maximum sequence length: source = 80; target = 81
[06/05/22 20:58:55 INFO]  * number of training sentences: 282954
[06/05/22 20:58:55 INFO]  * 1147 batches, max size: 256 (even), avg size: 246.690497, capacity: 100%
[06/05/22 20:58:55 INFO] Building model...
[06/05/22 20:58:55 INFO]  * Encoder:
[06/05/22 20:58:56 INFO]    - with word embeddings size: 512
[06/05/22 20:58:56 INFO]    - Simple LSTM Encoder: 2 layers, rnn_size 512, dropout 0.3
[06/05/22 20:58:56 INFO]  * Decoder:
[06/05/22 20:58:57 INFO]    - with word embeddings size: 512
[06/05/22 20:58:57 INFO]    - Global Attention: general
[06/05/22 20:58:59 INFO] Initializing parameters...
[06/05/22 20:59:01 INFO]  * number of parameters: 87096148
[06/05/22 20:59:01 INFO] Preparing memory optimization...
[06/05/22 20:59:01 INFO]  * sharing 69% of output/gradInput tensors memory between clones
[06/05/22 20:59:01 INFO] Start training...
[06/05/22 20:59:01 INFO] 
[06/05/22 21:03:29 INFO] Epoch 1 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 11633 ; Perplexity 2903.82
[06/05/22 21:07:41 INFO] Epoch 1 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12731 ; Perplexity 443.48
[06/05/22 21:08:54 INFO] Epoch 1 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12610 ; Perplexity 312.45
[06/05/22 21:09:02 INFO] Validation perplexity: 566.22
[06/05/22 21:09:02 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch1_566.22.t7'...
[06/05/22 21:09:05 INFO] 
[06/05/22 21:13:19 INFO] Epoch 2 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12636 ; Perplexity 250.00
[06/05/22 21:17:32 INFO] Epoch 2 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12367 ; Perplexity 161.37
[06/05/22 21:18:46 INFO] Epoch 2 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12184 ; Perplexity 91.65
[06/05/22 21:18:54 INFO] Validation perplexity: 86.82
[06/05/22 21:18:54 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch2_86.82.t7'...
[06/05/22 21:18:57 INFO] 
[06/05/22 21:23:12 INFO] Epoch 3 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12583 ; Perplexity 58.38
[06/05/22 21:27:22 INFO] Epoch 3 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12208 ; Perplexity 39.04
[06/05/22 21:28:38 INFO] Epoch 3 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12845 ; Perplexity 31.89
[06/05/22 21:28:47 INFO] Validation perplexity: 22.55
[06/05/22 21:28:47 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch3_22.55.t7'...
[06/05/22 21:28:50 INFO] 
[06/05/22 21:33:01 INFO] Epoch 4 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12429 ; Perplexity 27.07
[06/05/22 21:37:16 INFO] Epoch 4 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12534 ; Perplexity 23.62
[06/05/22 21:38:31 INFO] Epoch 4 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12312 ; Perplexity 22.10
[06/05/22 21:38:39 INFO] Validation perplexity: 17.51
[06/05/22 21:38:39 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch4_17.51.t7'...
[06/05/22 21:38:42 INFO] 
[06/05/22 21:42:55 INFO] Epoch 5 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12650 ; Perplexity 19.32
[06/05/22 21:47:09 INFO] Epoch 5 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12362 ; Perplexity 18.16
[06/05/22 21:48:23 INFO] Epoch 5 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12117 ; Perplexity 18.02
[06/05/22 21:48:32 INFO] Validation perplexity: 14.43
[06/05/22 21:48:32 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch5_14.43.t7'...
[06/05/22 21:48:34 INFO] 
[06/05/22 21:52:50 INFO] Epoch 6 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12472 ; Perplexity 15.79
[06/05/22 21:57:02 INFO] Epoch 6 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12308 ; Perplexity 15.34
[06/05/22 21:58:16 INFO] Epoch 6 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12836 ; Perplexity 14.99
[06/05/22 21:58:24 INFO] Validation perplexity: 13.06
[06/05/22 21:58:24 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch6_13.06.t7'...
[06/05/22 21:58:27 INFO] 
[06/05/22 22:02:38 INFO] Epoch 7 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12783 ; Perplexity 13.58
[06/05/22 22:06:52 INFO] Epoch 7 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12364 ; Perplexity 13.49
[06/05/22 22:08:05 INFO] Epoch 7 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12242 ; Perplexity 13.33
[06/05/22 22:08:14 INFO] Validation perplexity: 11.77
[06/05/22 22:08:14 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch7_11.77.t7'...
[06/05/22 22:08:16 INFO] 
[06/05/22 22:12:28 INFO] Epoch 8 ; Iteration 500/1147 ; Learning rate 0.7000 ; Source tokens/s 12915 ; Perplexity 11.25
[06/05/22 22:16:36 INFO] Epoch 8 ; Iteration 1000/1147 ; Learning rate 0.7000 ; Source tokens/s 12287 ; Perplexity 11.54
[06/05/22 22:17:53 INFO] Epoch 8 ; Iteration 1147/1147 ; Learning rate 0.7000 ; Source tokens/s 12175 ; Perplexity 11.32
[06/05/22 22:18:01 INFO] Validation perplexity: 11.07
[06/05/22 22:18:01 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch8_11.07.t7'...
[06/05/22 22:18:04 INFO] 
[06/05/22 22:22:17 INFO] Epoch 9 ; Iteration 500/1147 ; Learning rate 0.4900 ; Source tokens/s 12659 ; Perplexity 10.11
[06/05/22 22:26:29 INFO] Epoch 9 ; Iteration 1000/1147 ; Learning rate 0.4900 ; Source tokens/s 12516 ; Perplexity 10.09
[06/05/22 22:27:42 INFO] Epoch 9 ; Iteration 1147/1147 ; Learning rate 0.4900 ; Source tokens/s 12140 ; Perplexity 10.57
[06/05/22 22:27:50 INFO] Validation perplexity: 10.85
[06/05/22 22:27:50 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch9_10.85.t7'...
[06/05/22 22:27:53 INFO] 
[06/05/22 22:32:07 INFO] Epoch 10 ; Iteration 500/1147 ; Learning rate 0.3430 ; Source tokens/s 12550 ; Perplexity 9.32
[06/05/22 22:36:17 INFO] Epoch 10 ; Iteration 1000/1147 ; Learning rate 0.3430 ; Source tokens/s 12522 ; Perplexity 9.47
[06/05/22 22:37:31 INFO] Epoch 10 ; Iteration 1147/1147 ; Learning rate 0.3430 ; Source tokens/s 12383 ; Perplexity 9.39
[06/05/22 22:37:40 INFO] Validation perplexity: 10.49
[06/05/22 22:37:40 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch10_10.49.t7'...
[06/05/22 22:37:42 INFO] 
[06/05/22 22:41:56 INFO] Epoch 11 ; Iteration 500/1147 ; Learning rate 0.2401 ; Source tokens/s 12419 ; Perplexity 8.89
[06/05/22 22:46:07 INFO] Epoch 11 ; Iteration 1000/1147 ; Learning rate 0.2401 ; Source tokens/s 12566 ; Perplexity 8.87
[06/05/22 22:47:21 INFO] Epoch 11 ; Iteration 1147/1147 ; Learning rate 0.2401 ; Source tokens/s 12629 ; Perplexity 8.91
[06/05/22 22:47:29 INFO] Validation perplexity: 10.56
[06/05/22 22:47:29 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch11_10.56.t7'...
[06/05/22 22:47:32 INFO] 
[06/05/22 22:51:44 INFO] Epoch 12 ; Iteration 500/1147 ; Learning rate 0.1681 ; Source tokens/s 12666 ; Perplexity 8.46
[06/05/22 22:55:58 INFO] Epoch 12 ; Iteration 1000/1147 ; Learning rate 0.1681 ; Source tokens/s 12499 ; Perplexity 8.55
[06/05/22 22:57:10 INFO] Epoch 12 ; Iteration 1147/1147 ; Learning rate 0.1681 ; Source tokens/s 12068 ; Perplexity 8.72
[06/05/22 22:57:19 INFO] Validation perplexity: 10.30
[06/05/22 22:57:19 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch12_10.30.t7'...
[06/05/22 22:57:21 INFO] 
[06/05/22 23:01:32 INFO] Epoch 13 ; Iteration 500/1147 ; Learning rate 0.1176 ; Source tokens/s 12566 ; Perplexity 8.29
[06/05/22 23:05:46 INFO] Epoch 13 ; Iteration 1000/1147 ; Learning rate 0.1176 ; Source tokens/s 12628 ; Perplexity 8.26
[06/05/22 23:06:59 INFO] Epoch 13 ; Iteration 1147/1147 ; Learning rate 0.1176 ; Source tokens/s 12115 ; Perplexity 8.44
[06/05/22 23:07:07 INFO] Validation perplexity: 10.54
[06/05/22 23:07:07 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch13_10.54.t7'...
[06/05/22 23:07:10 INFO] 
[06/05/22 23:11:21 INFO] Epoch 14 ; Iteration 500/1147 ; Learning rate 0.0824 ; Source tokens/s 12434 ; Perplexity 8.11
[06/05/22 23:15:34 INFO] Epoch 14 ; Iteration 1000/1147 ; Learning rate 0.0824 ; Source tokens/s 12526 ; Perplexity 8.15
[06/05/22 23:16:48 INFO] Epoch 14 ; Iteration 1147/1147 ; Learning rate 0.0824 ; Source tokens/s 12837 ; Perplexity 8.10
[06/05/22 23:16:56 INFO] Validation perplexity: 10.39
[06/05/22 23:16:56 INFO] Saving checkpoint to '/workspace/models/nts_search_3_epoch14_10.39.t7'...
