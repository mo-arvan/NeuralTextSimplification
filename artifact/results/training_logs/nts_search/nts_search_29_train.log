[06/05/22 18:40:07 INFO] Using GPU(s): 2
[06/05/22 18:40:07 WARNING] The caching CUDA memory allocator is enabled. This allocator improves performance at the cost of a higher GPU memory usage. To optimize for memory, consider disabling it by setting the environment variable: THC_CACHING_ALLOCATOR=0
[06/05/22 18:40:07 INFO] Training Sequence to Sequence with Attention model
[06/05/22 18:40:07 INFO] Loading data from '/workspace/data/NTS-train.t7'...
[06/05/22 18:40:19 INFO]  * vocabulary size: source = 50004; target = 50004
[06/05/22 18:40:19 INFO]  * additional features: source = 0; target = 0
[06/05/22 18:40:19 INFO]  * maximum sequence length: source = 80; target = 81
[06/05/22 18:40:19 INFO]  * number of training sentences: 282954
[06/05/22 18:40:19 INFO]  * 1147 batches, max size: 256 (even), avg size: 246.690497, capacity: 100%
[06/05/22 18:40:19 INFO] Building model...
[06/05/22 18:40:19 INFO]  * Encoder:
[06/05/22 18:40:20 INFO]    - with word embeddings size: 512
[06/05/22 18:40:20 INFO]    - Simple LSTM Encoder: 2 layers, rnn_size 512, dropout 0.3
[06/05/22 18:40:20 INFO]  * Decoder:
[06/05/22 18:40:21 INFO]    - with word embeddings size: 512
[06/05/22 18:40:21 INFO]    - Global Attention: general
[06/05/22 18:40:23 INFO] Initializing parameters...
[06/05/22 18:40:25 INFO]  * number of parameters: 87096148
[06/05/22 18:40:25 INFO] Preparing memory optimization...
[06/05/22 18:40:25 INFO]  * sharing 69% of output/gradInput tensors memory between clones
[06/05/22 18:40:25 INFO] Start training...
[06/05/22 18:40:25 INFO] 
[06/05/22 18:44:50 INFO] Epoch 1 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 11500 ; Perplexity 2260.95
[06/05/22 18:49:09 INFO] Epoch 1 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12561 ; Perplexity 442.25
[06/05/22 18:50:24 INFO] Epoch 1 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12481 ; Perplexity 321.50
[06/05/22 18:50:33 INFO] Validation perplexity: 419.04
[06/05/22 18:50:33 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch1_419.04.t7'...
[06/05/22 18:50:36 INFO] 
[06/05/22 18:54:46 INFO] Epoch 2 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12380 ; Perplexity 250.63
[06/05/22 18:58:58 INFO] Epoch 2 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12448 ; Perplexity 166.99
[06/05/22 19:00:16 INFO] Epoch 2 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12831 ; Perplexity 97.43
[06/05/22 19:00:24 INFO] Validation perplexity: 85.21
[06/05/22 19:00:24 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch2_85.21.t7'...
[06/05/22 19:00:27 INFO] 
[06/05/22 19:04:37 INFO] Epoch 3 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12556 ; Perplexity 58.74
[06/05/22 19:08:51 INFO] Epoch 3 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12357 ; Perplexity 38.94
[06/05/22 19:10:08 INFO] Epoch 3 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12441 ; Perplexity 31.96
[06/05/22 19:10:17 INFO] Validation perplexity: 23.44
[06/05/22 19:10:17 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch3_23.44.t7'...
[06/05/22 19:10:19 INFO] 
[06/05/22 19:14:34 INFO] Epoch 4 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12827 ; Perplexity 26.78
[06/05/22 19:18:48 INFO] Epoch 4 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12320 ; Perplexity 23.79
[06/05/22 19:20:01 INFO] Epoch 4 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 11602 ; Perplexity 22.52
[06/05/22 19:20:10 INFO] Validation perplexity: 17.10
[06/05/22 19:20:10 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch4_17.10.t7'...
[06/05/22 19:20:12 INFO] 
[06/05/22 19:24:20 INFO] Epoch 5 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12509 ; Perplexity 19.37
[06/05/22 19:28:37 INFO] Epoch 5 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12675 ; Perplexity 18.28
[06/05/22 19:29:52 INFO] Epoch 5 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 11807 ; Perplexity 18.45
[06/05/22 19:30:00 INFO] Validation perplexity: 14.94
[06/05/22 19:30:00 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch5_14.94.t7'...
[06/05/22 19:30:02 INFO] 
[06/05/22 19:34:16 INFO] Epoch 6 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12573 ; Perplexity 15.85
[06/05/22 19:38:29 INFO] Epoch 6 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12444 ; Perplexity 15.53
[06/05/22 19:39:43 INFO] Epoch 6 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12248 ; Perplexity 15.30
[06/05/22 19:39:51 INFO] Validation perplexity: 13.65
[06/05/22 19:39:51 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch6_13.65.t7'...
[06/05/22 19:39:54 INFO] 
[06/05/22 19:44:04 INFO] Epoch 7 ; Iteration 500/1147 ; Learning rate 1.0000 ; Source tokens/s 12247 ; Perplexity 13.78
[06/05/22 19:48:19 INFO] Epoch 7 ; Iteration 1000/1147 ; Learning rate 1.0000 ; Source tokens/s 12719 ; Perplexity 13.58
[06/05/22 19:49:35 INFO] Epoch 7 ; Iteration 1147/1147 ; Learning rate 1.0000 ; Source tokens/s 12250 ; Perplexity 13.74
[06/05/22 19:49:43 INFO] Validation perplexity: 12.70
[06/05/22 19:49:43 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch7_12.70.t7'...
[06/05/22 19:49:46 INFO] 
[06/05/22 19:54:00 INFO] Epoch 8 ; Iteration 500/1147 ; Learning rate 0.7000 ; Source tokens/s 12325 ; Perplexity 11.46
[06/05/22 19:58:14 INFO] Epoch 8 ; Iteration 1000/1147 ; Learning rate 0.7000 ; Source tokens/s 12717 ; Perplexity 11.57
[06/05/22 19:59:27 INFO] Epoch 8 ; Iteration 1147/1147 ; Learning rate 0.7000 ; Source tokens/s 12046 ; Perplexity 11.43
[06/05/22 19:59:35 INFO] Validation perplexity: 11.03
[06/05/22 19:59:35 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch8_11.03.t7'...
[06/05/22 19:59:38 INFO] 
[06/05/22 20:03:50 INFO] Epoch 9 ; Iteration 500/1147 ; Learning rate 0.4900 ; Source tokens/s 12469 ; Perplexity 10.27
[06/05/22 20:08:02 INFO] Epoch 9 ; Iteration 1000/1147 ; Learning rate 0.4900 ; Source tokens/s 12587 ; Perplexity 10.24
[06/05/22 20:09:17 INFO] Epoch 9 ; Iteration 1147/1147 ; Learning rate 0.4900 ; Source tokens/s 12335 ; Perplexity 10.33
[06/05/22 20:09:25 INFO] Validation perplexity: 10.68
[06/05/22 20:09:25 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch9_10.68.t7'...
[06/05/22 20:09:28 INFO] 
[06/05/22 20:13:41 INFO] Epoch 10 ; Iteration 500/1147 ; Learning rate 0.3430 ; Source tokens/s 12336 ; Perplexity 9.48
[06/05/22 20:17:53 INFO] Epoch 10 ; Iteration 1000/1147 ; Learning rate 0.3430 ; Source tokens/s 12529 ; Perplexity 9.50
[06/05/22 20:19:07 INFO] Epoch 10 ; Iteration 1147/1147 ; Learning rate 0.3430 ; Source tokens/s 12983 ; Perplexity 9.50
[06/05/22 20:19:16 INFO] Validation perplexity: 10.62
[06/05/22 20:19:16 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch10_10.62.t7'...
[06/05/22 20:19:18 INFO] 
[06/05/22 20:23:30 INFO] Epoch 11 ; Iteration 500/1147 ; Learning rate 0.2401 ; Source tokens/s 12466 ; Perplexity 8.90
[06/05/22 20:27:44 INFO] Epoch 11 ; Iteration 1000/1147 ; Learning rate 0.2401 ; Source tokens/s 12620 ; Perplexity 9.00
[06/05/22 20:28:57 INFO] Epoch 11 ; Iteration 1147/1147 ; Learning rate 0.2401 ; Source tokens/s 12169 ; Perplexity 9.16
[06/05/22 20:29:06 INFO] Validation perplexity: 10.42
[06/05/22 20:29:06 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch11_10.42.t7'...
[06/05/22 20:29:08 INFO] 
[06/05/22 20:33:21 INFO] Epoch 12 ; Iteration 500/1147 ; Learning rate 0.1681 ; Source tokens/s 12668 ; Perplexity 8.61
[06/05/22 20:37:33 INFO] Epoch 12 ; Iteration 1000/1147 ; Learning rate 0.1681 ; Source tokens/s 12404 ; Perplexity 8.61
[06/05/22 20:38:49 INFO] Epoch 12 ; Iteration 1147/1147 ; Learning rate 0.1681 ; Source tokens/s 12072 ; Perplexity 8.67
[06/05/22 20:38:57 INFO] Validation perplexity: 10.42
[06/05/22 20:38:57 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch12_10.42.t7'...
[06/05/22 20:38:59 INFO] 
[06/05/22 20:43:12 INFO] Epoch 13 ; Iteration 500/1147 ; Learning rate 0.1176 ; Source tokens/s 12579 ; Perplexity 8.28
[06/05/22 20:47:23 INFO] Epoch 13 ; Iteration 1000/1147 ; Learning rate 0.1176 ; Source tokens/s 12547 ; Perplexity 8.40
[06/05/22 20:48:40 INFO] Epoch 13 ; Iteration 1147/1147 ; Learning rate 0.1176 ; Source tokens/s 11861 ; Perplexity 8.61
[06/05/22 20:48:48 INFO] Validation perplexity: 10.35
[06/05/22 20:48:48 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch13_10.35.t7'...
[06/05/22 20:48:51 INFO] 
[06/05/22 20:53:03 INFO] Epoch 14 ; Iteration 500/1147 ; Learning rate 0.0824 ; Source tokens/s 12662 ; Perplexity 8.11
[06/05/22 20:57:15 INFO] Epoch 14 ; Iteration 1000/1147 ; Learning rate 0.0824 ; Source tokens/s 12435 ; Perplexity 8.24
[06/05/22 20:58:31 INFO] Epoch 14 ; Iteration 1147/1147 ; Learning rate 0.0824 ; Source tokens/s 12053 ; Perplexity 8.39
[06/05/22 20:58:39 INFO] Validation perplexity: 10.33
[06/05/22 20:58:39 INFO] Saving checkpoint to '/workspace/models/nts_search_29_epoch14_10.33.t7'...
